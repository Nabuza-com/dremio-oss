#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "SELECT"
  input: "SELECT ename as employee_name, LOWER(employee_name) as lower_employee_name FROM emp"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKiAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS2wESDWVtcGxveWVlX25hbWUSE2xvd2VyX2VtcGxveWVlX25hbWUaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARp9ensKQSo/CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTESBwoFTE9XRVIaAnAAEjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAE="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 88 02 0A 28 74 79 70 65 2E 67 ..EMP....(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 DB 01 12 0D 65 6D 70 6C 6F 79 65 65 5F ct.Û...employee_"
     - "00000070 6E 61 6D 65 12 13 6C 6F 77 65 72 5F 65 6D 70 6C name..lower_empl"
     - "00000080 6F 79 65 65 5F 6E 61 6D 65 1A 36 12 34 0A 30 08 oyee_name.6.4.0."
     - "00000090 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "000000A0 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "000000B0 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "000000C0 01 1A 7D 7A 7B 0A 41 2A 3F 0A 30 08 01 10 1D 20 ..}z{.A*?.0.... "
     - "000000D0 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "000000E0 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "000000F0 0A 49 53 4F 2D 38 38 35 39 2D 31 12 07 0A 05 4C .ISO-8859-1....L"
     - "00000100 4F 57 45 52 1A 02 70 00 12 36 12 34 0A 30 08 01 OWER..p..6.4.0.."
     - "00000110 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "00000120 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "00000130 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
    queryPlanText:
     - "LogicalProject(employee_name=[$1], lower_employee_name=[LOWER($1)])"
     - "  LogicalTableScan(table=[[EMP]])"
 -
  description: "WHERE"
  input: "SELECT LOWER(ename) as lower_employee_name FROM emp WHERE lower_employee_name ='bob'"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKhAIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbEZpbHRlchLYARrVAXrSAQoaKhgKBAgBEAESCAoGRVFVQUxTGgJwABoCcAESQSo/CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTESBwoFTE9XRVIaAnACEjkiNwouEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRoDYm9iUBwSNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQrDAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKWAQgBEhNsb3dlcl9lbXBsb3llZV9uYW1lGn16ewpBKj8KMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRIHCgVMT1dFUhoCcAASNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQ=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 84 02 0A 27 74 79 70 65 2E 67 ..EMP....'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 an.PLogicalFilte"
     - "00000060 72 12 D8 01 1A D5 01 7A D2 01 0A 1A 2A 18 0A 04 r.Ø..Õ.zÒ...*..."
     - "00000070 08 01 10 01 12 08 0A 06 45 51 55 41 4C 53 1A 02 ........EQUALS.."
     - "00000080 70 00 1A 02 70 01 12 41 2A 3F 0A 30 08 01 10 1D p...p..A*?.0...."
     - "00000090 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000000A0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000000B0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 12 07 0A 05 2.ISO-8859-1...."
     - "000000C0 4C 4F 57 45 52 1A 02 70 02 12 39 22 37 0A 2E 10 LOWER..p..9\"7..."
     - "000000D0 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "000000E0 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "000000F0 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 1A 03 62 .2.ISO-8859-1..b"
     - "00000100 6F 62 50 1C 12 36 12 34 0A 30 08 01 10 1D 20 14 obP..6.4.0.... ."
     - "00000110 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "00000120 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "00000130 49 53 4F 2D 38 38 35 39 2D 31 10 01 0A C3 01 0A ISO-8859-1...Ã.."
     - "00000140 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 (type.googleapis"
     - "00000150 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000160 61 6C 50 72 6F 6A 65 63 74 12 96 01 08 01 12 13 alProject......."
     - "00000170 6C 6F 77 65 72 5F 65 6D 70 6C 6F 79 65 65 5F 6E lower_employee_n"
     - "00000180 61 6D 65 1A 7D 7A 7B 0A 41 2A 3F 0A 30 08 01 10 ame.}z{.A*?.0..."
     - "00000190 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "000001A0 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "000001B0 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 12 07 0A .2.ISO-8859-1..."
     - "000001C0 05 4C 4F 57 45 52 1A 02 70 00 12 36 12 34 0A 30 .LOWER..p..6.4.0"
     - "000001D0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001E0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001F0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000200 10 01                                           .."
    queryPlanText:
     - "LogicalProject(lower_employee_name=[LOWER($1)])"
     - "  LogicalFilter(condition=[=(LOWER($1), 'bob')])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "GROUP BY + HAVING"
  input: "SELECT MAX(deptno), LOWER(ename) as emp_name FROM emp GROUP BY emp_name HAVING emp_name = 'john'"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKygEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSnQESCGVtcF9uYW1lEgZERVBUTk8afXp7CkEqPwowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEgcKBUxPV0VSGgJwABI2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAHCl8KKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbEFnZ3JlZ2F0ZRIxCAESIxoFCgNNQVgqCAoGRVhQUiQwMgEBOP///////////wFKAgoAIgMKAQAqAwoBAArCAQondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEpYBEAIakQF6jgEKGioYCgQIARABEggKBkVRVUFMUxoCcAAaAnABEjQSMgowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEjoiOAouEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRoEam9oblAcCoIBCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0ElYIAxIGRVhQUiQwEghlbXBfbmFtZRoKEggKBAgBEAQQARo0EjIKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMQ=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A CA 01 0A 28 74 79 70 65 2E 67 ..EMP.Ê..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 9D 01 12 08 65 6D 70 5F 6E 61 6D 65 12 ct.....emp_name."
     - "00000070 06 44 45 50 54 4E 4F 1A 7D 7A 7B 0A 41 2A 3F 0A .DEPTNO.}z{.A*?."
     - "00000080 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "00000090 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000000A0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000000B0 31 12 07 0A 05 4C 4F 57 45 52 1A 02 70 00 12 36 1....LOWER..p..6"
     - "000000C0 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000000D0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000000E0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000000F0 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "00000100 10 07 0A 5F 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C ..._.*type.googl"
     - "00000110 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 eapis.com/plan.P"
     - "00000120 4C 6F 67 69 63 61 6C 41 67 67 72 65 67 61 74 65 LogicalAggregate"
     - "00000130 12 31 08 01 12 23 1A 05 0A 03 4D 41 58 2A 08 0A .1...#....MAX*.."
     - "00000140 06 45 58 50 52 24 30 32 01 01 38 FF FF FF FF FF .EXPR$02..8....."
     - "00000150 FF FF FF FF 01 4A 02 0A 00 22 03 0A 01 00 2A 03 .....J...\"....*."
     - "00000160 0A 01 00 0A C2 01 0A 27 74 79 70 65 2E 67 6F 6F ....Â..'type.goo"
     - "00000170 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "00000180 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 12 .PLogicalFilter."
     - "00000190 96 01 10 02 1A 91 01 7A 8E 01 0A 1A 2A 18 0A 04 .......z....*..."
     - "000001A0 08 01 10 01 12 08 0A 06 45 51 55 41 4C 53 1A 02 ........EQUALS.."
     - "000001B0 70 00 1A 02 70 01 12 34 12 32 0A 30 08 01 10 1D p...p..4.2.0...."
     - "000001C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000001D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000001E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 12 3A 22 38 2.ISO-8859-1.:\"8"
     - "000001F0 0A 2E 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000200 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000210 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000220 1A 04 6A 6F 68 6E 50 1C 0A 82 01 0A 28 74 79 70 ..johnP.....(typ"
     - "00000230 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "00000240 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "00000250 6F 6A 65 63 74 12 56 08 03 12 06 45 58 50 52 24 oject.V....EXPR$"
     - "00000260 30 12 08 65 6D 70 5F 6E 61 6D 65 1A 0A 12 08 0A 0..emp_name....."
     - "00000270 04 08 01 10 04 10 01 1A 34 12 32 0A 30 08 01 10 ........4.2.0..."
     - "00000280 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000290 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "000002A0 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31          .2.ISO-8859-1"
    queryPlanText:
     - "LogicalProject(EXPR$0=[$1], emp_name=[$0])"
     - "  LogicalFilter(condition=[=($0, 'john')])"
     - "    LogicalAggregate(group=[{0}], EXPR$0=[MAX($1)])"
     - "      LogicalProject(emp_name=[LOWER($1)], DEPTNO=[$7])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "ORDER BY"
  input: "SELECT LOWER(ename) as emp_name FROM emp ORDER BY emp_name"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKtgEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSiQESCGVtcF9uYW1lGn16ewpBKj8KMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRIHCgVMT1dFUhoCcAASNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQoxCiV0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxTb3J0EggIASIEEAEYAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A B6 01 0A 28 74 79 70 65 2E 67 ..EMP.¶..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 89 01 12 08 65 6D 70 5F 6E 61 6D 65 1A ct.....emp_name."
     - "00000070 7D 7A 7B 0A 41 2A 3F 0A 30 08 01 10 1D 20 14 2A }z{.A*?.0.... .*"
     - "00000080 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E ...ISO-8859-1$en"
     - "00000090 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 _US$primary(.2.I"
     - "000000A0 53 4F 2D 38 38 35 39 2D 31 12 07 0A 05 4C 4F 57 SO-8859-1....LOW"
     - "000000B0 45 52 1A 02 70 00 12 36 12 34 0A 30 08 01 10 1D ER..p..6.4.0...."
     - "000000C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000000D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000000E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 0A 31 2.ISO-8859-1...1"
     - "000000F0 0A 25 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 .%type.googleapi"
     - "00000100 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 s.com/plan.PLogi"
     - "00000110 63 61 6C 53 6F 72 74 12 08 08 01 22 04 10 01 18 calSort....\"...."
     - "00000120 03                                              ."
    queryPlanText:
     - "LogicalSort(sort0=[$0], dir0=[ASC])"
     - "  LogicalProject(emp_name=[LOWER($1)])"
     - "    LogicalTableScan(table=[[EMP]])"
