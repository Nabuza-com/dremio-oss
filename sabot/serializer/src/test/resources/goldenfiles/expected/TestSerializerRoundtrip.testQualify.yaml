#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "QUALIFY WITHOUT REFERENCES"
  input: "SELECT empno, ename, deptno FROM emp QUALIFY ROW_NUMBER() over (partition by ename order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKxQIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSmAISBWVtcG5vEgVlbmFtZRIGZGVwdG5vEhFRdWFsaWZ5RXhwcmVzc2lvbhoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBxqeAXqbAQoYKhYKAhABEggKBkVRVUFMUxoCcAAaAnABEiwyKgoCEAUSDAoKUk9XX05VTUJFUiIWCgJwAxIECgJwAhoEGgIIASICEgAoARINIgsKAhAFEgMSAQFQBhIKEggKBAgBEAQQBxI2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABCjcKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbEZpbHRlchIMEAEaCBIGCgIQARADCpIBCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0EmYIAhIFZW1wbm8SBWVuYW1lEgZkZXB0bm8aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAI="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A C5 02 0A 28 74 79 70 65 2E 67 ..EMP.Å..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 98 02 12 05 65 6D 70 6E 6F 12 05 65 6E ct.....empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 11 51 75 61 ame..deptno..Qua"
     - "00000080 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "00000090 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000A0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000B0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000C0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000D0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 9E 01 7A ...............z"
     - "000000E0 9B 01 0A 18 2A 16 0A 02 10 01 12 08 0A 06 45 51 ....*.........EQ"
     - "000000F0 55 41 4C 53 1A 02 70 00 1A 02 70 01 12 2C 32 2A UALS..p...p..,2*"
     - "00000100 0A 02 10 05 12 0C 0A 0A 52 4F 57 5F 4E 55 4D 42 ........ROW_NUMB"
     - "00000110 45 52 22 16 0A 02 70 03 12 04 0A 02 70 02 1A 04 ER\"...p.....p..."
     - "00000120 1A 02 08 01 22 02 12 00 28 01 12 0D 22 0B 0A 02 ....\"...(...\"..."
     - "00000130 10 05 12 03 12 01 01 50 06 12 0A 12 08 0A 04 08 .......P........"
     - "00000140 01 10 04 10 07 12 36 12 34 0A 30 08 01 10 1D 20 ......6.4.0.... "
     - "00000150 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "00000160 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "00000170 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 0A 37 0A .ISO-8859-1...7."
     - "00000180 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 'type.googleapis"
     - "00000190 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "000001A0 61 6C 46 69 6C 74 65 72 12 0C 10 01 1A 08 12 06 alFilter........"
     - "000001B0 0A 02 10 01 10 03 0A 92 01 0A 28 74 79 70 65 2E ..........(type."
     - "000001C0 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 googleapis.com/p"
     - "000001D0 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A lan.PLogicalProj"
     - "000001E0 65 63 74 12 66 08 02 12 05 65 6D 70 6E 6F 12 05 ect.f....empno.."
     - "000001F0 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F 1A 08 12 ename..deptno..."
     - "00000200 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000210 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000220 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000230 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000240 0A 12 08 0A 04 08 01 10 04 10 02                ..........."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalFilter(condition=[$3])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITHOUT REFERENCES AND FILTER"
  input: "SELECT empno, ename, deptno FROM emp WHERE deptno > 5 QUALIFY ROW_NUMBER() over (partition by ename order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKbAondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEkEaP3o9CiAqHgoECAEQARIOCgxHUkVBVEVSX1RIQU4aAnAAGgJwARIKEggKBAgBEAQQBxINIgsKAhAEEgMSAQVQBgrHAgoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKaAggBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcangF6mwEKGCoWCgIQARIICgZFUVVBTFMaAnAAGgJwARIsMioKAhAFEgwKClJPV19OVU1CRVIiFgoCcAMSBAoCcAIaBBoCCAEiAhIAKAESDSILCgIQBRIDEgEBUAYSChIICgQIARAEEAcSNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBACGggSBgoCEAEQAwqSAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJmCAMSBWVtcG5vEgVlbmFtZRIGZGVwdG5vGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAC"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 6C 0A 27 74 79 70 65 2E 67 6F ..EMP.l.'type.go"
     - "00000040 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 ogleapis.com/pla"
     - "00000050 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 n.PLogicalFilter"
     - "00000060 12 41 1A 3F 7A 3D 0A 20 2A 1E 0A 04 08 01 10 01 .A.?z=. *......."
     - "00000070 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 4E ....GREATER_THAN"
     - "00000080 1A 02 70 00 1A 02 70 01 12 0A 12 08 0A 04 08 01 ..p...p........."
     - "00000090 10 04 10 07 12 0D 22 0B 0A 02 10 04 12 03 12 01 ......\"........."
     - "000000A0 05 50 06 0A C7 02 0A 28 74 79 70 65 2E 67 6F 6F .P..Ç..(type.goo"
     - "000000B0 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "000000C0 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "000000D0 12 9A 02 08 01 12 05 65 6D 70 6E 6F 12 05 65 6E .......empno..en"
     - "000000E0 61 6D 65 12 06 64 65 70 74 6E 6F 12 11 51 75 61 ame..deptno..Qua"
     - "000000F0 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "00000100 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "00000110 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "00000120 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "00000130 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "00000140 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 9E 01 7A ...............z"
     - "00000150 9B 01 0A 18 2A 16 0A 02 10 01 12 08 0A 06 45 51 ....*.........EQ"
     - "00000160 55 41 4C 53 1A 02 70 00 1A 02 70 01 12 2C 32 2A UALS..p...p..,2*"
     - "00000170 0A 02 10 05 12 0C 0A 0A 52 4F 57 5F 4E 55 4D 42 ........ROW_NUMB"
     - "00000180 45 52 22 16 0A 02 70 03 12 04 0A 02 70 02 1A 04 ER\"...p.....p..."
     - "00000190 1A 02 08 01 22 02 12 00 28 01 12 0D 22 0B 0A 02 ....\"...(...\"..."
     - "000001A0 10 05 12 03 12 01 01 50 06 12 0A 12 08 0A 04 08 .......P........"
     - "000001B0 01 10 04 10 07 12 36 12 34 0A 30 08 01 10 1D 20 ......6.4.0.... "
     - "000001C0 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "000001D0 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "000001E0 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 0A 37 0A .ISO-8859-1...7."
     - "000001F0 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 'type.googleapis"
     - "00000200 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000210 61 6C 46 69 6C 74 65 72 12 0C 10 02 1A 08 12 06 alFilter........"
     - "00000220 0A 02 10 01 10 03 0A 92 01 0A 28 74 79 70 65 2E ..........(type."
     - "00000230 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 googleapis.com/p"
     - "00000240 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A lan.PLogicalProj"
     - "00000250 65 63 74 12 66 08 03 12 05 65 6D 70 6E 6F 12 05 ect.f....empno.."
     - "00000260 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F 1A 08 12 ename..deptno..."
     - "00000270 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000280 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000290 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "000002A0 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "000002B0 0A 12 08 0A 04 08 01 10 04 10 02                ..........."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalFilter(condition=[$3])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalFilter(condition=[>($7, 5)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH REFERENCES"
  input: "SELECT empno, ename, deptno, ROW_NUMBER() over (partition by ename order by deptno) as row_num FROM emp QUALIFY row_num = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKkAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS4wESBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAHGnR6cgosMioKAhAFEgwKClJPV19OVU1CRVIiFgoCcAESBAoCcAAaBBoCCAEiAhIAKAESChIICgQIARAEEAcSNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQrwAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBLDAQgBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIHcm93X251bRIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAIaCBIGCgIQBRADGjV6MwoYKhYKAhABEggKBkVRVUFMUxoCcAAaAnABEggSBgoCEAUQAxINIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBACGggSBgoCEAEQBAqlAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJ5CAMSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACGggSBgoCEAUQAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 90 02 0A 28 74 79 70 65 2E 67 ..EMP....(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 E3 01 12 05 65 6D 70 6E 6F 12 05 65 6E ct.ã...empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "00000080 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "00000090 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000000A0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000000B0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000000C0 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "000000D0 10 07 1A 74 7A 72 0A 2C 32 2A 0A 02 10 05 12 0C ...tzr.,2*......"
     - "000000E0 0A 0A 52 4F 57 5F 4E 55 4D 42 45 52 22 16 0A 02 ..ROW_NUMBER\"..."
     - "000000F0 70 01 12 04 0A 02 70 00 1A 04 1A 02 08 01 22 02 p.....p.......\"."
     - "00000100 12 00 28 01 12 0A 12 08 0A 04 08 01 10 04 10 07 ..(............."
     - "00000110 12 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 .6.4.0.... .*..."
     - "00000120 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000130 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000140 38 38 35 39 2D 31 10 01 0A F0 01 0A 28 74 79 70 8859-1...ð..(typ"
     - "00000150 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "00000160 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "00000170 6F 6A 65 63 74 12 C3 01 08 01 12 05 65 6D 70 6E oject.Ã.....empn"
     - "00000180 6F 12 05 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F o..ename..deptno"
     - "00000190 12 07 72 6F 77 5F 6E 75 6D 12 11 51 75 61 6C 69 ..row_num..Quali"
     - "000001A0 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 12 06 fyExpression...."
     - "000001B0 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D .......6.4.0...."
     - "000001C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000001D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000001E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 2.ISO-8859-1...."
     - "000001F0 12 08 0A 04 08 01 10 04 10 02 1A 08 12 06 0A 02 ................"
     - "00000200 10 05 10 03 1A 35 7A 33 0A 18 2A 16 0A 02 10 01 .....5z3..*....."
     - "00000210 12 08 0A 06 45 51 55 41 4C 53 1A 02 70 00 1A 02 ....EQUALS..p..."
     - "00000220 70 01 12 08 12 06 0A 02 10 05 10 03 12 0D 22 0B p.............\"."
     - "00000230 0A 02 10 05 12 03 12 01 01 50 06 0A 37 0A 27 74 .........P..7.'t"
     - "00000240 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "00000250 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "00000260 46 69 6C 74 65 72 12 0C 10 02 1A 08 12 06 0A 02 Filter.........."
     - "00000270 10 01 10 04 0A A5 01 0A 28 74 79 70 65 2E 67 6F .....¥..(type.go"
     - "00000280 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 ogleapis.com/pla"
     - "00000290 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 n.PLogicalProjec"
     - "000002A0 74 12 79 08 03 12 05 65 6D 70 6E 6F 12 05 65 6E t.y....empno..en"
     - "000002B0 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "000002C0 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "000002D0 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000002E0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000002F0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000300 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "00000310 10 02 1A 08 12 06 0A 02 10 05 10 03             ............"
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3], QualifyExpression=[=($3, 1)])"
     - "      LogicalProject(empno=[$0], ename=[$1], deptno=[$7], row_num=[ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH DERIVED COLUMN"
  input: "SELECT empno, ename, deptno, SUBSTRING(ename, 1, 1) as derived_column FROM emp QUALIFY ROW_NUMBER() over (partition by derived_column order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK7QQKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSwAQSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEg5kZXJpdmVkX2NvbHVtbhIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcaqAF6pQEKTSpLCjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTESCwoJU1VCU1RSSU5HGgJwABoCcAEaAnACEjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDSILCgIQBBIDEgEBUAYSDSILCgIQBBIDEgEBUAYaiwJ6iAIKGCoWCgIQARIICgZFUVVBTFMaAnAAGgJwARIsMioKAhAFEgwKClJPV19OVU1CRVIiFgoCcAMSBAoCcAIaBBoCCAEiAhIAKAESDSILCgIQBRIDEgEBUAYSChIICgQIARAEEAcSTSpLCjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTESCwoJU1VCU1RSSU5HGgJwBBoCcAUaAnAGEjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDSILCgIQBBIDEgEBUAYSDSILCgIQBBIDEgEBUAYKNwondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEgwQARoIEgYKAhABEAQK2wEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSrgEIAhIFZW1wbm8SBWVuYW1lEgZkZXB0bm8SDmRlcml2ZWRfY29sdW1uGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAM="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A ED 04 0A 28 74 79 70 65 2E 67 ..EMP.í..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 C0 04 12 05 65 6D 70 6E 6F 12 05 65 6E ct.À...empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 0E 64 65 72 ame..deptno..der"
     - "00000080 69 76 65 64 5F 63 6F 6C 75 6D 6E 12 11 51 75 61 ived_column..Qua"
     - "00000090 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "000000A0 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000B0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000C0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000D0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000E0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A A8 01 7A .............¨.z"
     - "000000F0 A5 01 0A 4D 2A 4B 0A 30 08 01 10 1D 20 14 2A 1C ¥..M*K.0.... .*."
     - "00000100 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F ..ISO-8859-1$en_"
     - "00000110 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 US$primary(.2.IS"
     - "00000120 4F 2D 38 38 35 39 2D 31 12 0B 0A 09 53 55 42 53 O-8859-1....SUBS"
     - "00000130 54 52 49 4E 47 1A 02 70 00 1A 02 70 01 1A 02 70 TRING..p...p...p"
     - "00000140 02 12 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A ..6.4.0.... .*.."
     - "00000150 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 .ISO-8859-1$en_U"
     - "00000160 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F S$primary(.2.ISO"
     - "00000170 2D 38 38 35 39 2D 31 10 01 12 0D 22 0B 0A 02 10 -8859-1....\"...."
     - "00000180 04 12 03 12 01 01 50 06 12 0D 22 0B 0A 02 10 04 ......P...\"....."
     - "00000190 12 03 12 01 01 50 06 1A 8B 02 7A 88 02 0A 18 2A .....P....z....*"
     - "000001A0 16 0A 02 10 01 12 08 0A 06 45 51 55 41 4C 53 1A .........EQUALS."
     - "000001B0 02 70 00 1A 02 70 01 12 2C 32 2A 0A 02 10 05 12 .p...p..,2*....."
     - "000001C0 0C 0A 0A 52 4F 57 5F 4E 55 4D 42 45 52 22 16 0A ...ROW_NUMBER\".."
     - "000001D0 02 70 03 12 04 0A 02 70 02 1A 04 1A 02 08 01 22 .p.....p.......\""
     - "000001E0 02 12 00 28 01 12 0D 22 0B 0A 02 10 05 12 03 12 ...(...\"........"
     - "000001F0 01 01 50 06 12 0A 12 08 0A 04 08 01 10 04 10 07 ..P............."
     - "00000200 12 4D 2A 4B 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 .M*K.0.... .*..."
     - "00000210 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000220 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000230 38 38 35 39 2D 31 12 0B 0A 09 53 55 42 53 54 52 8859-1....SUBSTR"
     - "00000240 49 4E 47 1A 02 70 04 1A 02 70 05 1A 02 70 06 12 ING..p...p...p.."
     - "00000250 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 6.4.0.... .*...I"
     - "00000260 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 SO-8859-1$en_US$"
     - "00000270 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 primary(.2.ISO-8"
     - "00000280 38 35 39 2D 31 10 01 12 0D 22 0B 0A 02 10 04 12 859-1....\"......"
     - "00000290 03 12 01 01 50 06 12 0D 22 0B 0A 02 10 04 12 03 ....P...\"......."
     - "000002A0 12 01 01 50 06 0A 37 0A 27 74 79 70 65 2E 67 6F ...P..7.'type.go"
     - "000002B0 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 ogleapis.com/pla"
     - "000002C0 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 n.PLogicalFilter"
     - "000002D0 12 0C 10 01 1A 08 12 06 0A 02 10 01 10 04 0A DB ...............Û"
     - "000002E0 01 0A 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 ..(type.googleap"
     - "000002F0 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 is.com/plan.PLog"
     - "00000300 69 63 61 6C 50 72 6F 6A 65 63 74 12 AE 01 08 02 icalProject.®..."
     - "00000310 12 05 65 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 ..empno..ename.."
     - "00000320 64 65 70 74 6E 6F 12 0E 64 65 72 69 76 65 64 5F deptno..derived_"
     - "00000330 63 6F 6C 75 6D 6E 1A 08 12 06 0A 04 08 01 10 04 column.........."
     - "00000340 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 .6.4.0.... .*..."
     - "00000350 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000360 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000370 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 8859-1.........."
     - "00000380 10 04 10 02 1A 36 12 34 0A 30 08 01 10 1D 20 14 .....6.4.0.... ."
     - "00000390 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "000003A0 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "000003B0 49 53 4F 2D 38 38 35 39 2D 31 10 03             ISO-8859-1.."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], derived_column=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], derived_column=[SUBSTRING($1, 1, 1)], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY SUBSTRING($1, 1, 1) ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH WINDOW CLAUSE"
  input: "SELECT empno, ename, deptno, ROW_NUMBER() over myWindow as row_num FROM emp WINDOW myWindow AS (PARTITION BY ename ORDER BY deptno) QUALIFY row_num = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKkAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS4wESBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAHGnR6cgosMioKAhAFEgwKClJPV19OVU1CRVIiFgoCcAESBAoCcAAaBBoCCAEiAhIAKAESChIICgQIARAEEAcSNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQrwAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBLDAQgBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIHcm93X251bRIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAIaCBIGCgIQBRADGjV6MwoYKhYKAhABEggKBkVRVUFMUxoCcAAaAnABEggSBgoCEAUQAxINIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBACGggSBgoCEAEQBAqlAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJ5CAMSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACGggSBgoCEAUQAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 90 02 0A 28 74 79 70 65 2E 67 ..EMP....(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 E3 01 12 05 65 6D 70 6E 6F 12 05 65 6E ct.ã...empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "00000080 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "00000090 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000000A0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000000B0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000000C0 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "000000D0 10 07 1A 74 7A 72 0A 2C 32 2A 0A 02 10 05 12 0C ...tzr.,2*......"
     - "000000E0 0A 0A 52 4F 57 5F 4E 55 4D 42 45 52 22 16 0A 02 ..ROW_NUMBER\"..."
     - "000000F0 70 01 12 04 0A 02 70 00 1A 04 1A 02 08 01 22 02 p.....p.......\"."
     - "00000100 12 00 28 01 12 0A 12 08 0A 04 08 01 10 04 10 07 ..(............."
     - "00000110 12 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 .6.4.0.... .*..."
     - "00000120 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000130 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000140 38 38 35 39 2D 31 10 01 0A F0 01 0A 28 74 79 70 8859-1...ð..(typ"
     - "00000150 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "00000160 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "00000170 6F 6A 65 63 74 12 C3 01 08 01 12 05 65 6D 70 6E oject.Ã.....empn"
     - "00000180 6F 12 05 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F o..ename..deptno"
     - "00000190 12 07 72 6F 77 5F 6E 75 6D 12 11 51 75 61 6C 69 ..row_num..Quali"
     - "000001A0 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 12 06 fyExpression...."
     - "000001B0 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D .......6.4.0...."
     - "000001C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000001D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000001E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 2.ISO-8859-1...."
     - "000001F0 12 08 0A 04 08 01 10 04 10 02 1A 08 12 06 0A 02 ................"
     - "00000200 10 05 10 03 1A 35 7A 33 0A 18 2A 16 0A 02 10 01 .....5z3..*....."
     - "00000210 12 08 0A 06 45 51 55 41 4C 53 1A 02 70 00 1A 02 ....EQUALS..p..."
     - "00000220 70 01 12 08 12 06 0A 02 10 05 10 03 12 0D 22 0B p.............\"."
     - "00000230 0A 02 10 05 12 03 12 01 01 50 06 0A 37 0A 27 74 .........P..7.'t"
     - "00000240 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "00000250 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "00000260 46 69 6C 74 65 72 12 0C 10 02 1A 08 12 06 0A 02 Filter.........."
     - "00000270 10 01 10 04 0A A5 01 0A 28 74 79 70 65 2E 67 6F .....¥..(type.go"
     - "00000280 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 ogleapis.com/pla"
     - "00000290 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 n.PLogicalProjec"
     - "000002A0 74 12 79 08 03 12 05 65 6D 70 6E 6F 12 05 65 6E t.y....empno..en"
     - "000002B0 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "000002C0 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "000002D0 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000002E0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000002F0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000300 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "00000310 10 02 1A 08 12 06 0A 02 10 05 10 03             ............"
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3], QualifyExpression=[=($3, 1)])"
     - "      LogicalProject(empno=[$0], ename=[$1], deptno=[$7], row_num=[ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY IN SUBQUERY"
  input: "SELECT * FROM ( SELECT DISTINCT empno, ename, deptno  FROM emp  QUALIFY RANK() OVER (PARTITION BY ename ORDER BY deptno DESC) = 1 )"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKwAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSkwISBWVtcG5vEgVlbmFtZRIGZGVwdG5vEhFRdWFsaWZ5RXhwcmVzc2lvbhoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBxqZAXqWAQoYKhYKAhABEggKBkVRVUFMUxoCcAAaAnABEicyJQoCEAUSBgoEUkFOSyIXCgJwAxIHCgJwAiIBARoEGgIIASICEgASDSILCgIQBRIDEgEBUAYSChIICgQIARAEEAcSNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAQo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBABGggSBgoCEAEQAwqSAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJmCAISBWVtcG5vEgVlbmFtZRIGZGVwdG5vGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACCj4KKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbEFnZ3JlZ2F0ZRIQCAMiBQoDAAECKgUKAwABAgqSAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJmCAQSBWVtcG5vEgVlbmFtZRIGZGVwdG5vGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAC"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A C0 02 0A 28 74 79 70 65 2E 67 ..EMP.À..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 93 02 12 05 65 6D 70 6E 6F 12 05 65 6E ct.....empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 11 51 75 61 ame..deptno..Qua"
     - "00000080 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "00000090 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000A0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000B0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000C0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000D0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 99 01 7A ...............z"
     - "000000E0 96 01 0A 18 2A 16 0A 02 10 01 12 08 0A 06 45 51 ....*.........EQ"
     - "000000F0 55 41 4C 53 1A 02 70 00 1A 02 70 01 12 27 32 25 UALS..p...p..'2%"
     - "00000100 0A 02 10 05 12 06 0A 04 52 41 4E 4B 22 17 0A 02 ........RANK\"..."
     - "00000110 70 03 12 07 0A 02 70 02 22 01 01 1A 04 1A 02 08 p.....p.\"......."
     - "00000120 01 22 02 12 00 12 0D 22 0B 0A 02 10 05 12 03 12 .\".....\"........"
     - "00000130 01 01 50 06 12 0A 12 08 0A 04 08 01 10 04 10 07 ..P............."
     - "00000140 12 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 .6.4.0.... .*..."
     - "00000150 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000160 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000170 38 38 35 39 2D 31 10 01 0A 37 0A 27 74 79 70 65 8859-1...7.'type"
     - "00000180 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F .googleapis.com/"
     - "00000190 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 6C plan.PLogicalFil"
     - "000001A0 74 65 72 12 0C 10 01 1A 08 12 06 0A 02 10 01 10 ter............."
     - "000001B0 03 0A 92 01 0A 28 74 79 70 65 2E 67 6F 6F 67 6C .....(type.googl"
     - "000001C0 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 eapis.com/plan.P"
     - "000001D0 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 66 LogicalProject.f"
     - "000001E0 08 02 12 05 65 6D 70 6E 6F 12 05 65 6E 61 6D 65 ....empno..ename"
     - "000001F0 12 06 64 65 70 74 6E 6F 1A 08 12 06 0A 04 08 01 ..deptno........"
     - "00000200 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C ...6.4.0.... .*."
     - "00000210 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F ..ISO-8859-1$en_"
     - "00000220 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 US$primary(.2.IS"
     - "00000230 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 O-8859-1........"
     - "00000240 08 01 10 04 10 02 0A 3E 0A 2A 74 79 70 65 2E 67 .......>.*type.g"
     - "00000250 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000260 61 6E 2E 50 4C 6F 67 69 63 61 6C 41 67 67 72 65 an.PLogicalAggre"
     - "00000270 67 61 74 65 12 10 08 03 22 05 0A 03 00 01 02 2A gate....\"......*"
     - "00000280 05 0A 03 00 01 02 0A 92 01 0A 28 74 79 70 65 2E ..........(type."
     - "00000290 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 googleapis.com/p"
     - "000002A0 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A lan.PLogicalProj"
     - "000002B0 65 63 74 12 66 08 04 12 05 65 6D 70 6E 6F 12 05 ect.f....empno.."
     - "000002C0 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F 1A 08 12 ename..deptno..."
     - "000002D0 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "000002E0 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "000002F0 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000300 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000310 0A 12 08 0A 04 08 01 10 04 10 02                ..........."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalAggregate(group=[{0, 1, 2}])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "      LogicalFilter(condition=[$3])"
     - "        LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(RANK() OVER (PARTITION BY $1 ORDER BY $7 DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "          LogicalTableScan(table=[[EMP]])"
