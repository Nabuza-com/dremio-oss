#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "WINDOW function"
  input: "select sum(a) over(partition by b) as col1, count(*) over(partition by c) as col2 from t1"
  output:
    queryPlanBinary: "CjIKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIECgJUMQpZCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0Ei0SAUESAUISAUMaChIICgQIARAEEAEaChIICgQIARAEEAIaChIICgQIARAEEAMKqAIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxL8AQgBGm4KAQEaBBoCCAEiBBoCCAIqAgoAMit6KQodahsKEQoCEAUSBwoFQ09VTlQaAnAAEgYKAhgBIAMSCBIGCgQIARAEMix6KgoeahwKEAoCEAUSBgoEU1VNMBoCcAASBgoCGAEgAxgBEggSBgoECAEQBBowCgECGgQaAggBIgQaAggCKgIKADIbahkKDQoCEAUSBwoFQ09VTlQSBgoCGAEgAxgCIlYQKEgCUgkKAUEaBAgBEARSCwoBQhABGgQIARAEUgsKAUMQAhoECAEQBFINCgV3MCRvMBADGgIQBVINCgV3MCRvMRAEGgIQBVINCgV3MSRvMBAFGgIQBQq2AQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKJAQgCEgRjb2wxEgRjb2wyGm96bQocKhoKBAgBEAUSBgoEQ0FTRRoCcAAaAnABGgJwAhIeKhwKAhABEg4KDEdSRUFURVJfVEhBThoCcAMaAnAEEggSBgoCEAUQBBIKIggKBAgBEAVQIBIIEgYKAhAFEAMSDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAF"
    queryPlanBinaryHexDump:
     - "00000000 0A 32 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .2.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 04 gicalTableScan.."
     - "00000030 0A 02 54 31 0A 59 0A 28 74 79 70 65 2E 67 6F 6F ..T1.Y.(type.goo"
     - "00000040 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "00000050 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "00000060 12 2D 12 01 41 12 01 42 12 01 43 1A 0A 12 08 0A .-..A..B..C....."
     - "00000070 04 08 01 10 04 10 01 1A 0A 12 08 0A 04 08 01 10 ................"
     - "00000080 04 10 02 1A 0A 12 08 0A 04 08 01 10 04 10 03 0A ................"
     - "00000090 A8 02 0A 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 ¨..'type.googlea"
     - "000000A0 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "000000B0 67 69 63 61 6C 57 69 6E 64 6F 77 12 FC 01 08 01 gicalWindow.ü..."
     - "000000C0 1A 6E 0A 01 01 1A 04 1A 02 08 01 22 04 1A 02 08 .n.........\"...."
     - "000000D0 02 2A 02 0A 00 32 2B 7A 29 0A 1D 6A 1B 0A 11 0A .*...2+z)..j...."
     - "000000E0 02 10 05 12 07 0A 05 43 4F 55 4E 54 1A 02 70 00 .......COUNT..p."
     - "000000F0 12 06 0A 02 18 01 20 03 12 08 12 06 0A 04 08 01 ...... ........."
     - "00000100 10 04 32 2C 7A 2A 0A 1E 6A 1C 0A 10 0A 02 10 05 ..2,z*..j......."
     - "00000110 12 06 0A 04 53 55 4D 30 1A 02 70 00 12 06 0A 02 ....SUM0..p....."
     - "00000120 18 01 20 03 18 01 12 08 12 06 0A 04 08 01 10 04 .. ............."
     - "00000130 1A 30 0A 01 02 1A 04 1A 02 08 01 22 04 1A 02 08 .0.........\"...."
     - "00000140 02 2A 02 0A 00 32 1B 6A 19 0A 0D 0A 02 10 05 12 .*...2.j........"
     - "00000150 07 0A 05 43 4F 55 4E 54 12 06 0A 02 18 01 20 03 ...COUNT...... ."
     - "00000160 18 02 22 56 10 28 48 02 52 09 0A 01 41 1A 04 08 ..\"V.(H.R...A..."
     - "00000170 01 10 04 52 0B 0A 01 42 10 01 1A 04 08 01 10 04 ...R...B........"
     - "00000180 52 0B 0A 01 43 10 02 1A 04 08 01 10 04 52 0D 0A R...C........R.."
     - "00000190 05 77 30 24 6F 30 10 03 1A 02 10 05 52 0D 0A 05 .w0$o0......R..."
     - "000001A0 77 30 24 6F 31 10 04 1A 02 10 05 52 0D 0A 05 77 w0$o1......R...w"
     - "000001B0 31 24 6F 30 10 05 1A 02 10 05 0A B6 01 0A 28 74 1$o0.......¶..(t"
     - "000001C0 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "000001D0 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "000001E0 50 72 6F 6A 65 63 74 12 89 01 08 02 12 04 63 6F Project.......co"
     - "000001F0 6C 31 12 04 63 6F 6C 32 1A 6F 7A 6D 0A 1C 2A 1A l1..col2.ozm..*."
     - "00000200 0A 04 08 01 10 05 12 06 0A 04 43 41 53 45 1A 02 ..........CASE.."
     - "00000210 70 00 1A 02 70 01 1A 02 70 02 12 1E 2A 1C 0A 02 p...p...p...*..."
     - "00000220 10 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 ......GREATER_TH"
     - "00000230 41 4E 1A 02 70 03 1A 02 70 04 12 08 12 06 0A 02 AN..p...p......."
     - "00000240 10 05 10 04 12 0A 22 08 0A 04 08 01 10 05 50 20 ......\".......P "
     - "00000250 12 08 12 06 0A 02 10 05 10 03 12 0D 22 0B 0A 02 ............\"..."
     - "00000260 10 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 10 .......P........"
     - "00000270 05 10 05                                        ..."
    queryPlanText:
     - "LogicalProject(col1=[CASE(>($3, 0), $4, null:BIGINT)], col2=[$5])"
     - "  LogicalWindow(window#0=[window(partition {1} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT($0), $SUM0($0)])], window#1=[window(partition {2} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT()])])"
     - "    LogicalProject(A=[$1], B=[$2], C=[$3])"
     - "      LogicalTableScan(table=[[T1]])"
 -
  description: "Calculate the Rank of Employees Based on Salary"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    RANK() OVER (PARTITION BY DEPTNO ORDER BY SAL DESC) AS SALARY_RANK\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK6wIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxK/Aho3CgEHGgQaAggBIgISACoKCggKBggFEAMYAjIcahoKDAoCEAUSBgoEUkFOSxIKCgIYARABGAEgAyKDAhAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUjkKA0pPQhACGjAIARAdIAoqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSDQoDTUdSEAMaBAgBEARSFAoISElSRURBVEUQBBoGCAEQDSADUg0KA1NBTBAFGgQIARAEUg4KBENPTU0QBhoECAEQBFIQCgZERVBUTk8QBxoECAEQBFIRCgdTTEFDS0VSEAgaBAgBEAFSDQoFdzAkbzAQCRoCEAUKuwEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjgEIARIFRU1QTk8SBUVOQU1FEgZERVBUTk8SA1NBTBILU0FMQVJZX1JBTksaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcaChIICgQIARAEEAUaCBIGCgIQBRAJ"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A EB 02 0A 27 74 79 70 65 2E 67 ..EMP.ë..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 BF 02 1A 37 0A 01 07 1A 04 1A 02 08 01 22 w.¿..7.........\""
     - "00000070 02 12 00 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 ...*...........2"
     - "00000080 1C 6A 1A 0A 0C 0A 02 10 05 12 06 0A 04 52 41 4E .j...........RAN"
     - "00000090 4B 12 0A 0A 02 18 01 10 01 18 01 20 03 22 83 02 K.......... .\".."
     - "000000A0 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000000B0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000000C0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000000D0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000000E0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000000F0 52 39 0A 03 4A 4F 42 10 02 1A 30 08 01 10 1D 20 R9..JOB...0.... "
     - "00000100 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "00000110 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "00000120 0A 49 53 4F 2D 38 38 35 39 2D 31 52 0D 0A 03 4D .ISO-8859-1R...M"
     - "00000130 47 52 10 03 1A 04 08 01 10 04 52 14 0A 08 48 49 GR........R...HI"
     - "00000140 52 45 44 41 54 45 10 04 1A 06 08 01 10 0D 20 03 REDATE........ ."
     - "00000150 52 0D 0A 03 53 41 4C 10 05 1A 04 08 01 10 04 52 R...SAL........R"
     - "00000160 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 01 10 04 52 ...COMM........R"
     - "00000170 10 0A 06 44 45 50 54 4E 4F 10 07 1A 04 08 01 10 ...DEPTNO......."
     - "00000180 04 52 11 0A 07 53 4C 41 43 4B 45 52 10 08 1A 04 .R...SLACKER...."
     - "00000190 08 01 10 01 52 0D 0A 05 77 30 24 6F 30 10 09 1A ....R...w0$o0..."
     - "000001A0 02 10 05 0A BB 01 0A 28 74 79 70 65 2E 67 6F 6F ....»..(type.goo"
     - "000001B0 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "000001C0 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "000001D0 12 8E 01 08 01 12 05 45 4D 50 4E 4F 12 05 45 4E .......EMPNO..EN"
     - "000001E0 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 41 4C AME..DEPTNO..SAL"
     - "000001F0 12 0B 53 41 4C 41 52 59 5F 52 41 4E 4B 1A 08 12 ..SALARY_RANK..."
     - "00000200 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000210 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000220 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000230 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000240 0A 12 08 0A 04 08 01 10 04 10 07 1A 0A 12 08 0A ................"
     - "00000250 04 08 01 10 04 10 05 1A 08 12 06 0A 02 10 05 10 ................"
     - "00000260 09                                              ."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$7], SAL=[$5], SALARY_RANK=[$9])"
     - "  LogicalWindow(window#0=[window(partition {7} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [RANK()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Running Total of Salaries by Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    SUM(SAL) OVER (PARTITION BY DEPTNO ORDER BY HIREDATE) AS RUNNING_TOTAL_SAL\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKugEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjQESBUVNUE5PEgVFTkFNRRIISElSRURBVEUSA1NBTBIGREVQVE5PGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUaChIICgQIARAEEAcK0AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKkAggBGngKAQQaBBoCCAEiAhIAKgoKCAoGCAIQARgDMi16KwodahsKEQoCEAUSBwoFQ09VTlQaAnAAEgYKAhgBIAMSChIICgQIARAEEAMyLnosCh5qHAoQCgIQBRIGCgRTVU0wGgJwABIGCgIYASADGAESChIICgQIARAEEAMipQEQKEgCUg0KBUVNUE5PGgQIARAEUjsKBUVOQU1FEAEaMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVIUCghISVJFREFURRACGgYIARANIANSDQoDU0FMEAMaBAgBEARSEAoGREVQVE5PEAQaBAgBEARSDQoFdzAkbzAQBRoCEAVSDQoFdzAkbzEQBhoCEAUKqAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS+wEIAhIFRU1QTk8SBUVOQU1FEgZERVBUTk8SA1NBTBIRUlVOTklOR19UT1RBTF9TQUwaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAQaChIICgQIARAEEAMab3ptChwqGgoECAEQBRIGCgRDQVNFGgJwABoCcAEaAnACEh4qHAoCEAESDgoMR1JFQVRFUl9USEFOGgJwAxoCcAQSCBIGCgIQBRAGEgoiCAoECAEQBVAgEggSBgoCEAUQBRINIgsKAhAFEgMSAQBQBg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A BA 01 0A 28 74 79 70 65 2E 67 ..EMP.º..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 8D 01 12 05 45 4D 50 4E 4F 12 05 45 4E ct.....EMPNO..EN"
     - "00000070 41 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 AME..HIREDATE..S"
     - "00000080 41 4C 12 06 44 45 50 54 4E 4F 1A 08 12 06 0A 04 AL..DEPTNO......"
     - "00000090 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 .....6.4.0.... ."
     - "000000A0 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "000000B0 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "000000C0 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0C 12 0A ISO-8859-1......"
     - "000000D0 0A 06 08 01 10 0D 20 03 10 04 1A 0A 12 08 0A 04 ...... ........."
     - "000000E0 08 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 ................"
     - "000000F0 10 07 0A D0 02 0A 27 74 79 70 65 2E 67 6F 6F 67 ...Ð..'type.goog"
     - "00000100 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000110 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F 77 12 A4 PLogicalWindow.¤"
     - "00000120 02 08 01 1A 78 0A 01 04 1A 04 1A 02 08 01 22 02 ....x.........\"."
     - "00000130 12 00 2A 0A 0A 08 0A 06 08 02 10 01 18 03 32 2D ..*...........2-"
     - "00000140 7A 2B 0A 1D 6A 1B 0A 11 0A 02 10 05 12 07 0A 05 z+..j..........."
     - "00000150 43 4F 55 4E 54 1A 02 70 00 12 06 0A 02 18 01 20 COUNT..p....... "
     - "00000160 03 12 0A 12 08 0A 04 08 01 10 04 10 03 32 2E 7A .............2.z"
     - "00000170 2C 0A 1E 6A 1C 0A 10 0A 02 10 05 12 06 0A 04 53 ,..j...........S"
     - "00000180 55 4D 30 1A 02 70 00 12 06 0A 02 18 01 20 03 18 UM0..p....... .."
     - "00000190 01 12 0A 12 08 0A 04 08 01 10 04 10 03 22 A5 01 .............\"¥."
     - "000001A0 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000001B0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000001C0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001D0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001E0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001F0 52 14 0A 08 48 49 52 45 44 41 54 45 10 02 1A 06 R...HIREDATE...."
     - "00000200 08 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 03 1A .... .R...SAL..."
     - "00000210 04 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 .....R...DEPTNO."
     - "00000220 04 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 6F 30 .......R...w0$o0"
     - "00000230 10 05 1A 02 10 05 52 0D 0A 05 77 30 24 6F 31 10 ......R...w0$o1."
     - "00000240 06 1A 02 10 05 0A A8 02 0A 28 74 79 70 65 2E 67 ......¨..(type.g"
     - "00000250 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000260 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000270 63 74 12 FB 01 08 02 12 05 45 4D 50 4E 4F 12 05 ct.û.....EMPNO.."
     - "00000280 45 4E 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 ENAME..DEPTNO..S"
     - "00000290 41 4C 12 11 52 55 4E 4E 49 4E 47 5F 54 4F 54 41 AL..RUNNING_TOTA"
     - "000002A0 4C 5F 53 41 4C 1A 08 12 06 0A 04 08 01 10 04 1A L_SAL..........."
     - "000002B0 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 6.4.0.... .*...I"
     - "000002C0 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 SO-8859-1$en_US$"
     - "000002D0 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 primary(.2.ISO-8"
     - "000002E0 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 859-1..........."
     - "000002F0 04 10 04 1A 0A 12 08 0A 04 08 01 10 04 10 03 1A ................"
     - "00000300 6F 7A 6D 0A 1C 2A 1A 0A 04 08 01 10 05 12 06 0A ozm..*.........."
     - "00000310 04 43 41 53 45 1A 02 70 00 1A 02 70 01 1A 02 70 .CASE..p...p...p"
     - "00000320 02 12 1E 2A 1C 0A 02 10 01 12 0E 0A 0C 47 52 45 ...*.........GRE"
     - "00000330 41 54 45 52 5F 54 48 41 4E 1A 02 70 03 1A 02 70 ATER_THAN..p...p"
     - "00000340 04 12 08 12 06 0A 02 10 05 10 06 12 0A 22 08 0A .............\".."
     - "00000350 04 08 01 10 05 50 20 12 08 12 06 0A 02 10 05 10 .....P ........."
     - "00000360 05 12 0D 22 0B 0A 02 10 05 12 03 12 01 00 50 06 ...\"..........P."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$4], SAL=[$3], RUNNING_TOTAL_SAL=[CASE(>($5, 0), $6, null:BIGINT)])"
     - "  LogicalWindow(window#0=[window(partition {4} order by [2] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Find the Highest Salary in Each Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    MAX(SAL) OVER (PARTITION BY DEPTNO) AS MAX_SALARY_IN_DEPT\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK+AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLMAhpCCgEHGgQaAggBIgQaAggCKgIKADIteisKHWobChEKBAgBEAQSBQoDTUFYGgJwABIGCgIYAyADEgoSCAoECAEQBBAFIoUCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVIPCgV3MCRvMBAJGgQIARAECsQBCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0EpcBCAESBUVNUE5PEgVFTkFNRRIGREVQVE5PEgNTQUwSEk1BWF9TQUxBUllfSU5fREVQVBoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBxoKEggKBAgBEAQQBRoKEggKBAgBEAQQCQ=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A F8 02 0A 27 74 79 70 65 2E 67 ..EMP.ø..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 CC 02 1A 42 0A 01 07 1A 04 1A 02 08 01 22 w.Ì..B.........\""
     - "00000070 04 1A 02 08 02 2A 02 0A 00 32 2D 7A 2B 0A 1D 6A .....*...2-z+..j"
     - "00000080 1B 0A 11 0A 04 08 01 10 04 12 05 0A 03 4D 41 58 .............MAX"
     - "00000090 1A 02 70 00 12 06 0A 02 18 03 20 03 12 0A 12 08 ..p....... ....."
     - "000000A0 0A 04 08 01 10 04 10 05 22 85 02 10 28 48 02 52 ........\"...(H.R"
     - "000000B0 0D 0A 05 45 4D 50 4E 4F 1A 04 08 01 10 04 52 3B ...EMPNO......R;"
     - "000000C0 0A 05 45 4E 41 4D 45 10 01 1A 30 08 01 10 1D 20 ..ENAME...0.... "
     - "000000D0 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "000000E0 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "000000F0 0A 49 53 4F 2D 38 38 35 39 2D 31 52 39 0A 03 4A .ISO-8859-1R9..J"
     - "00000100 4F 42 10 02 1A 30 08 01 10 1D 20 0A 2A 1C 0A 18 OB...0.... .*..."
     - "00000110 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 ISO-8859-1$en_US"
     - "00000120 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D $primary(.2.ISO-"
     - "00000130 38 38 35 39 2D 31 52 0D 0A 03 4D 47 52 10 03 1A 8859-1R...MGR..."
     - "00000140 04 08 01 10 04 52 14 0A 08 48 49 52 45 44 41 54 .....R...HIREDAT"
     - "00000150 45 10 04 1A 06 08 01 10 0D 20 03 52 0D 0A 03 53 E........ .R...S"
     - "00000160 41 4C 10 05 1A 04 08 01 10 04 52 0E 0A 04 43 4F AL........R...CO"
     - "00000170 4D 4D 10 06 1A 04 08 01 10 04 52 10 0A 06 44 45 MM........R...DE"
     - "00000180 50 54 4E 4F 10 07 1A 04 08 01 10 04 52 11 0A 07 PTNO........R..."
     - "00000190 53 4C 41 43 4B 45 52 10 08 1A 04 08 01 10 01 52 SLACKER........R"
     - "000001A0 0F 0A 05 77 30 24 6F 30 10 09 1A 04 08 01 10 04 ...w0$o0........"
     - "000001B0 0A C4 01 0A 28 74 79 70 65 2E 67 6F 6F 67 6C 65 .Ä..(type.google"
     - "000001C0 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C apis.com/plan.PL"
     - "000001D0 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 97 01 ogicalProject..."
     - "000001E0 08 01 12 05 45 4D 50 4E 4F 12 05 45 4E 41 4D 45 ....EMPNO..ENAME"
     - "000001F0 12 06 44 45 50 54 4E 4F 12 03 53 41 4C 12 12 4D ..DEPTNO..SAL..M"
     - "00000200 41 58 5F 53 41 4C 41 52 59 5F 49 4E 5F 44 45 50 AX_SALARY_IN_DEP"
     - "00000210 54 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A T...........6.4."
     - "00000220 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "00000230 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "00000240 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "00000250 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 1..............."
     - "00000260 0A 12 08 0A 04 08 01 10 04 10 05 1A 0A 12 08 0A ................"
     - "00000270 04 08 01 10 04 10 09                            ......."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$7], SAL=[$5], MAX_SALARY_IN_DEPT=[$9])"
     - "  LogicalWindow(window#0=[window(partition {7} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [MAX($5)])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Difference Between an Employee's Salary and the Average Salary of Their Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    AVG(SAL) OVER (PARTITION BY DEPTNO) AS AVG_DEPT_SAL,\n    SAL - AVG(SAL) OVER (PARTITION BY DEPTNO) AS SALARY_DIFF_FROM_AVG\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKoQEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSdRIFRU1QTk8SBUVOQU1FEgNTQUwSBkRFUFROTxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoKEggKBAgBEAQQBwq0AgondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsV2luZG93EogCCAEacgoBAxoEGgIIASIEGgIIAioCCgAyLXorCh1qGwoRCgIQBRIHCgVDT1VOVBoCcAASBgoCGAEgAxIKEggKBAgBEAQQAjIueiwKHmocChAKAhAFEgYKBFNVTTAaAnAAEgYKAhgBIAMYARIKEggKBAgBEAQQAiKPARAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUg0KA1NBTBACGgQIARAEUhAKBkRFUFROTxADGgQIARAEUg0KBXcwJG8wEAQaAhAFUg0KBXcwJG8xEAUaAhAFCtEFCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0EqQFCAISBUVNUE5PEgVFTkFNRRIGREVQVE5PEgNTQUwSDEFWR19ERVBUX1NBTBIUU0FMQVJZX0RJRkZfRlJPTV9BVkcaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAMaChIICgQIARAEEAIa7gF66wEKGioYCgQIARAJEggKBkRJVklERRoCcAAaAnABElYqVAoECAEQCRJIEgRDQVNUIipvcmcuYXBhY2hlLmNhbGNpdGUuc3FsLmZ1bi5TcWxDYXN0RnVuY3Rpb24o////////////ATD///////////8BGgJwAhIIEgYKAhAFEAQSHCoaCgQIARAFEgYKBENBU0UaAnADGgJwBBoCcAUSHiocCgIQARIOCgxHUkVBVEVSX1RIQU4aAnAGGgJwBxIIEgYKAhAFEAUSCiIICgQIARAFUCASCBIGCgIQBRAEEg0iCwoCEAUSAxIBAFAGGpUCepICChkqFwoECAEQCRIHCgVNSU5VUxoCcAAaAnABEgoSCAoECAEQBBACEhoqGAoECAEQCRIICgZESVZJREUaAnACGgJwAxJWKlQKBAgBEAkSSBIEQ0FTVCIqb3JnLmFwYWNoZS5jYWxjaXRlLnNxbC5mdW4uU3FsQ2FzdEZ1bmN0aW9uKP///////////wEw////////////ARoCcAQSCBIGCgIQBRAEEhwqGgoECAEQBRIGCgRDQVNFGgJwBRoCcAYaAnAHEh4qHAoCEAESDgoMR1JFQVRFUl9USEFOGgJwCBoCcAkSCBIGCgIQBRAFEgoiCAoECAEQBVAgEggSBgoCEAUQBBINIgsKAhAFEgMSAQBQBg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A A1 01 0A 28 74 79 70 65 2E 67 ..EMP.¡..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 75 12 05 45 4D 50 4E 4F 12 05 45 4E 41 ct.u..EMPNO..ENA"
     - "00000070 4D 45 12 03 53 41 4C 12 06 44 45 50 54 4E 4F 1A ME..SAL..DEPTNO."
     - "00000080 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 ..........6.4.0."
     - "00000090 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "000000A0 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "000000B0 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "000000C0 01 1A 0A 12 08 0A 04 08 01 10 04 10 05 1A 0A 12 ................"
     - "000000D0 08 0A 04 08 01 10 04 10 07 0A B4 02 0A 27 74 79 ..........´..'ty"
     - "000000E0 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F pe.googleapis.co"
     - "000000F0 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 m/plan.PLogicalW"
     - "00000100 69 6E 64 6F 77 12 88 02 08 01 1A 72 0A 01 03 1A indow......r...."
     - "00000110 04 1A 02 08 01 22 04 1A 02 08 02 2A 02 0A 00 32 .....\".....*...2"
     - "00000120 2D 7A 2B 0A 1D 6A 1B 0A 11 0A 02 10 05 12 07 0A -z+..j.........."
     - "00000130 05 43 4F 55 4E 54 1A 02 70 00 12 06 0A 02 18 01 .COUNT..p......."
     - "00000140 20 03 12 0A 12 08 0A 04 08 01 10 04 10 02 32 2E  .............2."
     - "00000150 7A 2C 0A 1E 6A 1C 0A 10 0A 02 10 05 12 06 0A 04 z,..j..........."
     - "00000160 53 55 4D 30 1A 02 70 00 12 06 0A 02 18 01 20 03 SUM0..p....... ."
     - "00000170 18 01 12 0A 12 08 0A 04 08 01 10 04 10 02 22 8F ..............\"."
     - "00000180 01 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 ..(H.R...EMPNO.."
     - "00000190 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A ....R;..ENAME..."
     - "000001A0 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "000001B0 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000001C0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000001D0 31 52 0D 0A 03 53 41 4C 10 02 1A 04 08 01 10 04 1R...SAL........"
     - "000001E0 52 10 0A 06 44 45 50 54 4E 4F 10 03 1A 04 08 01 R...DEPTNO......"
     - "000001F0 10 04 52 0D 0A 05 77 30 24 6F 30 10 04 1A 02 10 ..R...w0$o0....."
     - "00000200 05 52 0D 0A 05 77 30 24 6F 31 10 05 1A 02 10 05 .R...w0$o1......"
     - "00000210 0A D1 05 0A 28 74 79 70 65 2E 67 6F 6F 67 6C 65 .Ñ..(type.google"
     - "00000220 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C apis.com/plan.PL"
     - "00000230 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 A4 05 ogicalProject.¤."
     - "00000240 08 02 12 05 45 4D 50 4E 4F 12 05 45 4E 41 4D 45 ....EMPNO..ENAME"
     - "00000250 12 06 44 45 50 54 4E 4F 12 03 53 41 4C 12 0C 41 ..DEPTNO..SAL..A"
     - "00000260 56 47 5F 44 45 50 54 5F 53 41 4C 12 14 53 41 4C VG_DEPT_SAL..SAL"
     - "00000270 41 52 59 5F 44 49 46 46 5F 46 52 4F 4D 5F 41 56 ARY_DIFF_FROM_AV"
     - "00000280 47 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A G...........6.4."
     - "00000290 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "000002A0 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000002B0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000002C0 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 03 1A 1..............."
     - "000002D0 0A 12 08 0A 04 08 01 10 04 10 02 1A EE 01 7A EB ............î.zë"
     - "000002E0 01 0A 1A 2A 18 0A 04 08 01 10 09 12 08 0A 06 44 ...*...........D"
     - "000002F0 49 56 49 44 45 1A 02 70 00 1A 02 70 01 12 56 2A IVIDE..p...p..V*"
     - "00000300 54 0A 04 08 01 10 09 12 48 12 04 43 41 53 54 22 T.......H..CAST\""
     - "00000310 2A 6F 72 67 2E 61 70 61 63 68 65 2E 63 61 6C 63 *org.apache.calc"
     - "00000320 69 74 65 2E 73 71 6C 2E 66 75 6E 2E 53 71 6C 43 ite.sql.fun.SqlC"
     - "00000330 61 73 74 46 75 6E 63 74 69 6F 6E 28 FF FF FF FF astFunction(...."
     - "00000340 FF FF FF FF FF 01 30 FF FF FF FF FF FF FF FF FF ......0........."
     - "00000350 01 1A 02 70 02 12 08 12 06 0A 02 10 05 10 04 12 ...p............"
     - "00000360 1C 2A 1A 0A 04 08 01 10 05 12 06 0A 04 43 41 53 .*...........CAS"
     - "00000370 45 1A 02 70 03 1A 02 70 04 1A 02 70 05 12 1E 2A E..p...p...p...*"
     - "00000380 1C 0A 02 10 01 12 0E 0A 0C 47 52 45 41 54 45 52 .........GREATER"
     - "00000390 5F 54 48 41 4E 1A 02 70 06 1A 02 70 07 12 08 12 _THAN..p...p...."
     - "000003A0 06 0A 02 10 05 10 05 12 0A 22 08 0A 04 08 01 10 .........\"......"
     - "000003B0 05 50 20 12 08 12 06 0A 02 10 05 10 04 12 0D 22 .P ............\""
     - "000003C0 0B 0A 02 10 05 12 03 12 01 00 50 06 1A 95 02 7A ..........P....z"
     - "000003D0 92 02 0A 19 2A 17 0A 04 08 01 10 09 12 07 0A 05 ....*..........."
     - "000003E0 4D 49 4E 55 53 1A 02 70 00 1A 02 70 01 12 0A 12 MINUS..p...p...."
     - "000003F0 08 0A 04 08 01 10 04 10 02 12 1A 2A 18 0A 04 08 ...........*...."
     - "00000400 01 10 09 12 08 0A 06 44 49 56 49 44 45 1A 02 70 .......DIVIDE..p"
     - "00000410 02 1A 02 70 03 12 56 2A 54 0A 04 08 01 10 09 12 ...p..V*T......."
     - "00000420 48 12 04 43 41 53 54 22 2A 6F 72 67 2E 61 70 61 H..CAST\"*org.apa"
     - "00000430 63 68 65 2E 63 61 6C 63 69 74 65 2E 73 71 6C 2E che.calcite.sql."
     - "00000440 66 75 6E 2E 53 71 6C 43 61 73 74 46 75 6E 63 74 fun.SqlCastFunct"
     - "00000450 69 6F 6E 28 FF FF FF FF FF FF FF FF FF 01 30 FF ion(..........0."
     - "00000460 FF FF FF FF FF FF FF FF 01 1A 02 70 04 12 08 12 ...........p...."
     - "00000470 06 0A 02 10 05 10 04 12 1C 2A 1A 0A 04 08 01 10 .........*......"
     - "00000480 05 12 06 0A 04 43 41 53 45 1A 02 70 05 1A 02 70 .....CASE..p...p"
     - "00000490 06 1A 02 70 07 12 1E 2A 1C 0A 02 10 01 12 0E 0A ...p...*........"
     - "000004A0 0C 47 52 45 41 54 45 52 5F 54 48 41 4E 1A 02 70 .GREATER_THAN..p"
     - "000004B0 08 1A 02 70 09 12 08 12 06 0A 02 10 05 10 05 12 ...p............"
     - "000004C0 0A 22 08 0A 04 08 01 10 05 50 20 12 08 12 06 0A .\".......P ....."
     - "000004D0 02 10 05 10 04 12 0D 22 0B 0A 02 10 05 12 03 12 .......\"........"
     - "000004E0 01 00 50 06                                     ..P."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$3], SAL=[$2], AVG_DEPT_SAL=[/(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4)], SALARY_DIFF_FROM_AVG=[-($2, /(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4))])"
     - "  LogicalWindow(window#0=[window(partition {3} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT($2), $SUM0($2)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Find the Previous and Next Employee's Salary"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    LAG(SAL) OVER (ORDER BY HIREDATE) AS PREV_SALARY,\n    LEAD(SAL) OVER (ORDER BY HIREDATE) AS NEXT_SALARY\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKwgMKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKWAxp7GgQaAggBIgISACoKCggKBggEEAEYAzIvei0KH2odChEKBAgBEAQSBQoDTEFHGgJwABIICgIYARABIAMSChIICgQIARAEEAUyMnowCiJqIAoSCgQIARAEEgYKBExFQUQaAnAAEggKAhgBEAEgAxgBEgoSCAoECAEQBBAFIpYCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVIPCgV3MCRvMBAJGgQIARAEUg8KBXcwJG8xEAoaBAgBEAQKsAEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSgwEIARIFRU1QTk8SBUVOQU1FEgNTQUwSAiQzEgIkNBoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoKEggKBAgBEAQQCRoKEggKBAgBEAQQCg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A C2 03 0A 27 74 79 70 65 2E 67 ..EMP.Â..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 96 03 1A 7B 1A 04 1A 02 08 01 22 02 12 00 w....{......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 04 10 01 18 03 32 2F 7A 2D *...........2/z-"
     - "00000080 0A 1F 6A 1D 0A 11 0A 04 08 01 10 04 12 05 0A 03 ..j............."
     - "00000090 4C 41 47 1A 02 70 00 12 08 0A 02 18 01 10 01 20 LAG..p......... "
     - "000000A0 03 12 0A 12 08 0A 04 08 01 10 04 10 05 32 32 7A .............22z"
     - "000000B0 30 0A 22 6A 20 0A 12 0A 04 08 01 10 04 12 06 0A 0.\"j ..........."
     - "000000C0 04 4C 45 41 44 1A 02 70 00 12 08 0A 02 18 01 10 .LEAD..p........"
     - "000000D0 01 20 03 18 01 12 0A 12 08 0A 04 08 01 10 04 10 . .............."
     - "000000E0 05 22 96 02 10 28 48 02 52 0D 0A 05 45 4D 50 4E .\"...(H.R...EMPN"
     - "000000F0 4F 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 O......R;..ENAME"
     - "00000100 10 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 ...0.... .*...IS"
     - "00000110 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "00000120 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000130 35 39 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 08 59-1R9..JOB...0."
     - "00000140 01 10 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "00000150 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "00000160 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 52 y(.2.ISO-8859-1R"
     - "00000170 0D 0A 03 4D 47 52 10 03 1A 04 08 01 10 04 52 14 ...MGR........R."
     - "00000180 0A 08 48 49 52 45 44 41 54 45 10 04 1A 06 08 01 ..HIREDATE......"
     - "00000190 10 0D 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 08 .. .R...SAL....."
     - "000001A0 01 10 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 ...R...COMM....."
     - "000001B0 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 1A ...R...DEPTNO..."
     - "000001C0 04 08 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 52 .....R...SLACKER"
     - "000001D0 10 08 1A 04 08 01 10 01 52 0F 0A 05 77 30 24 6F ........R...w0$o"
     - "000001E0 30 10 09 1A 04 08 01 10 04 52 0F 0A 05 77 30 24 0........R...w0$"
     - "000001F0 6F 31 10 0A 1A 04 08 01 10 04 0A B0 01 0A 28 74 o1.........°..(t"
     - "00000200 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "00000210 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "00000220 50 72 6F 6A 65 63 74 12 83 01 08 01 12 05 45 4D Project.......EM"
     - "00000230 50 4E 4F 12 05 45 4E 41 4D 45 12 03 53 41 4C 12 PNO..ENAME..SAL."
     - "00000240 02 24 33 12 02 24 34 1A 08 12 06 0A 04 08 01 10 .$3..$4........."
     - "00000250 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A ..6.4.0.... .*.."
     - "00000260 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 .ISO-8859-1$en_U"
     - "00000270 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F S$primary(.2.ISO"
     - "00000280 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 -8859-1........."
     - "00000290 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 10 ................"
     - "000002A0 09 1A 0A 12 08 0A 04 08 01 10 04 10 0A          ............."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9], $4=[$10])"
     - "  LogicalWindow(window#0=[window(partition {} order by [4] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [LAG($5), LEAD($5)])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Percent Rank of Each Employee's Salary Within the Company"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    PERCENT_RANK() OVER (ORDER BY SAL DESC) AS SALARY_PERCENT_RANK\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK8AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLEAho8GgQaAggBIgISACoKCggKBggFEAMYAjIkaiIKFAoCEAkSDgoMUEVSQ0VOVF9SQU5LEgoKAhgBEAEYASADIoMCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVINCgV3MCRvMBAJGgIQCQqdAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJxCAESBUVNUE5PEgVFTkFNRRIDU0FMEgIkMxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoIEgYKAhAJEAk="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A F0 02 0A 27 74 79 70 65 2E 67 ..EMP.ð..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 C4 02 1A 3C 1A 04 1A 02 08 01 22 02 12 00 w.Ä..<......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 24 6A 22 *...........2$j\""
     - "00000080 0A 14 0A 02 10 09 12 0E 0A 0C 50 45 52 43 45 4E ..........PERCEN"
     - "00000090 54 5F 52 41 4E 4B 12 0A 0A 02 18 01 10 01 18 01 T_RANK.........."
     - "000000A0 20 03 22 83 02 10 28 48 02 52 0D 0A 05 45 4D 50  .\"...(H.R...EMP"
     - "000000B0 4E 4F 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D NO......R;..ENAM"
     - "000000C0 45 10 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 E...0.... .*...I"
     - "000000D0 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 SO-8859-1$en_US$"
     - "000000E0 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 primary(.2.ISO-8"
     - "000000F0 38 35 39 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 859-1R9..JOB...0"
     - "00000100 08 01 10 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000110 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000120 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000130 52 0D 0A 03 4D 47 52 10 03 1A 04 08 01 10 04 52 R...MGR........R"
     - "00000140 14 0A 08 48 49 52 45 44 41 54 45 10 04 1A 06 08 ...HIREDATE....."
     - "00000150 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 ... .R...SAL...."
     - "00000160 08 01 10 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 ....R...COMM...."
     - "00000170 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 ....R...DEPTNO.."
     - "00000180 1A 04 08 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 ......R...SLACKE"
     - "00000190 52 10 08 1A 04 08 01 10 01 52 0D 0A 05 77 30 24 R........R...w0$"
     - "000001A0 6F 30 10 09 1A 02 10 09 0A 9D 01 0A 28 74 79 70 o0..........(typ"
     - "000001B0 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "000001C0 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "000001D0 6F 6A 65 63 74 12 71 08 01 12 05 45 4D 50 4E 4F oject.q....EMPNO"
     - "000001E0 12 05 45 4E 41 4D 45 12 03 53 41 4C 12 02 24 33 ..ENAME..SAL..$3"
     - "000001F0 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 ...........6.4.0"
     - "00000200 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000210 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000220 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000230 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 05 1A 08 ................"
     - "00000240 12 06 0A 02 10 09 10 09                         ........"
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9])"
     - "  LogicalWindow(window#0=[window(partition {} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [PERCENT_RANK()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Cumulative Distribution of Employees' Salaries"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    CUME_DIST() OVER (ORDER BY SAL DESC) AS SALARY_CUME_DIST\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK7QIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLBAho5GgQaAggBIgISACoKCggKBggFEAMYAjIhah8KEQoCEAkSCwoJQ1VNRV9ESVNUEgoKAhgBEAEYASADIoMCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVINCgV3MCRvMBAJGgIQCQqdAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJxCAESBUVNUE5PEgVFTkFNRRIDU0FMEgIkMxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoIEgYKAhAJEAk="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A ED 02 0A 27 74 79 70 65 2E 67 ..EMP.í..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 C1 02 1A 39 1A 04 1A 02 08 01 22 02 12 00 w.Á..9......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 21 6A 1F *...........2!j."
     - "00000080 0A 11 0A 02 10 09 12 0B 0A 09 43 55 4D 45 5F 44 ..........CUME_D"
     - "00000090 49 53 54 12 0A 0A 02 18 01 10 01 18 01 20 03 22 IST.......... .\""
     - "000000A0 83 02 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A ...(H.R...EMPNO."
     - "000000B0 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 .....R;..ENAME.."
     - "000000C0 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D .0.... .*...ISO-"
     - "000000D0 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 8859-1$en_US$pri"
     - "000000E0 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 mary(.2.ISO-8859"
     - "000000F0 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 08 01 10 -1R9..JOB...0..."
     - "00000100 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000110 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000120 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 52 0D 0A .2.ISO-8859-1R.."
     - "00000130 03 4D 47 52 10 03 1A 04 08 01 10 04 52 14 0A 08 .MGR........R..."
     - "00000140 48 49 52 45 44 41 54 45 10 04 1A 06 08 01 10 0D HIREDATE........"
     - "00000150 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 08 01 10  .R...SAL......."
     - "00000160 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 01 10 .R...COMM......."
     - "00000170 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 1A 04 08 .R...DEPTNO....."
     - "00000180 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 52 10 08 ...R...SLACKER.."
     - "00000190 1A 04 08 01 10 01 52 0D 0A 05 77 30 24 6F 30 10 ......R...w0$o0."
     - "000001A0 09 1A 02 10 09 0A 9D 01 0A 28 74 79 70 65 2E 67 .........(type.g"
     - "000001B0 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "000001C0 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "000001D0 63 74 12 71 08 01 12 05 45 4D 50 4E 4F 12 05 45 ct.q....EMPNO..E"
     - "000001E0 4E 41 4D 45 12 03 53 41 4C 12 02 24 33 1A 08 12 NAME..SAL..$3..."
     - "000001F0 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000200 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000210 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000220 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000230 0A 12 08 0A 04 08 01 10 04 10 05 1A 08 12 06 0A ................"
     - "00000240 02 10 09 10 09                                  ....."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9])"
     - "  LogicalWindow(window#0=[window(partition {} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [CUME_DIST()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Moving Average of Salaries Over the Last 3 Employees by Hire Date"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    AVG(SAL) OVER (ORDER BY HIREDATE ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS MOVING_AVG_SAL\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKpQEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSeRIFRU1QTk8SBUVOQU1FEghISVJFREFURRIDU0FMGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUK1wIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKrAggBEg0iCwoCEAQSAxIBAlAGGoEBEAEaDgoMCggSBgoCEAQQBBABIgISACoKCggKBggCEAEYAzIteisKHWobChEKAhAFEgcKBUNPVU5UGgJwABIGCgIYASADEgoSCAoECAEQBBADMi56LAoeahwKEAoCEAUSBgoEU1VNMBoCcAASBgoCGAEgAxgBEgoSCAoECAEQBBADIpMBEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSFAoISElSRURBVEUQAhoGCAEQDSADUg0KA1NBTBADGgQIARAEUg0KBXcwJG8wEAQaAhAFUg0KBXcwJG8xEAUaAhAFCpEDCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0EuQCCAISBUVNUE5PEgVFTkFNRRIDU0FMEg5NT1ZJTkdfQVZHX1NBTBoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQAxruAXrrAQoaKhgKBAgBEAkSCAoGRElWSURFGgJwABoCcAESVipUCgQIARAJEkgSBENBU1QiKm9yZy5hcGFjaGUuY2FsY2l0ZS5zcWwuZnVuLlNxbENhc3RGdW5jdGlvbij///////////8BMP///////////wEaAnACEggSBgoCEAUQBBIcKhoKBAgBEAUSBgoEQ0FTRRoCcAMaAnAEGgJwBRIeKhwKAhABEg4KDEdSRUFURVJfVEhBThoCcAYaAnAHEggSBgoCEAUQBRIKIggKBAgBEAVQIBIIEgYKAhAFEAQSDSILCgIQBRIDEgEAUAY="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A A5 01 0A 28 74 79 70 65 2E 67 ..EMP.¥..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 79 12 05 45 4D 50 4E 4F 12 05 45 4E 41 ct.y..EMPNO..ENA"
     - "00000070 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 41 ME..HIREDATE..SA"
     - "00000080 4C 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A L...........6.4."
     - "00000090 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "000000A0 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000000B0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000000C0 31 10 01 1A 0C 12 0A 0A 06 08 01 10 0D 20 03 10 1............ .."
     - "000000D0 04 1A 0A 12 08 0A 04 08 01 10 04 10 05 0A D7 02 ..............×."
     - "000000E0 0A 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 .'type.googleapi"
     - "000000F0 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 s.com/plan.PLogi"
     - "00000100 63 61 6C 57 69 6E 64 6F 77 12 AB 02 08 01 12 0D calWindow.«....."
     - "00000110 22 0B 0A 02 10 04 12 03 12 01 02 50 06 1A 81 01 \"..........P...."
     - "00000120 10 01 1A 0E 0A 0C 0A 08 12 06 0A 02 10 04 10 04 ................"
     - "00000130 10 01 22 02 12 00 2A 0A 0A 08 0A 06 08 02 10 01 ..\"...*........."
     - "00000140 18 03 32 2D 7A 2B 0A 1D 6A 1B 0A 11 0A 02 10 05 ..2-z+..j......."
     - "00000150 12 07 0A 05 43 4F 55 4E 54 1A 02 70 00 12 06 0A ....COUNT..p...."
     - "00000160 02 18 01 20 03 12 0A 12 08 0A 04 08 01 10 04 10 ... ............"
     - "00000170 03 32 2E 7A 2C 0A 1E 6A 1C 0A 10 0A 02 10 05 12 .2.z,..j........"
     - "00000180 06 0A 04 53 55 4D 30 1A 02 70 00 12 06 0A 02 18 ...SUM0..p......"
     - "00000190 01 20 03 18 01 12 0A 12 08 0A 04 08 01 10 04 10 . .............."
     - "000001A0 03 22 93 01 10 28 48 02 52 0D 0A 05 45 4D 50 4E .\"...(H.R...EMPN"
     - "000001B0 4F 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 O......R;..ENAME"
     - "000001C0 10 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 ...0.... .*...IS"
     - "000001D0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000001E0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000001F0 35 39 2D 31 52 14 0A 08 48 49 52 45 44 41 54 45 59-1R...HIREDATE"
     - "00000200 10 02 1A 06 08 01 10 0D 20 03 52 0D 0A 03 53 41 ........ .R...SA"
     - "00000210 4C 10 03 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 L........R...w0$"
     - "00000220 6F 30 10 04 1A 02 10 05 52 0D 0A 05 77 30 24 6F o0......R...w0$o"
     - "00000230 31 10 05 1A 02 10 05 0A 91 03 0A 28 74 79 70 65 1..........(type"
     - "00000240 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F .googleapis.com/"
     - "00000250 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F plan.PLogicalPro"
     - "00000260 6A 65 63 74 12 E4 02 08 02 12 05 45 4D 50 4E 4F ject.ä.....EMPNO"
     - "00000270 12 05 45 4E 41 4D 45 12 03 53 41 4C 12 0E 4D 4F ..ENAME..SAL..MO"
     - "00000280 56 49 4E 47 5F 41 56 47 5F 53 41 4C 1A 08 12 06 VING_AVG_SAL...."
     - "00000290 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D .......6.4.0...."
     - "000002A0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000002B0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000002C0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 2.ISO-8859-1...."
     - "000002D0 12 08 0A 04 08 01 10 04 10 03 1A EE 01 7A EB 01 ...........î.zë."
     - "000002E0 0A 1A 2A 18 0A 04 08 01 10 09 12 08 0A 06 44 49 ..*...........DI"
     - "000002F0 56 49 44 45 1A 02 70 00 1A 02 70 01 12 56 2A 54 VIDE..p...p..V*T"
     - "00000300 0A 04 08 01 10 09 12 48 12 04 43 41 53 54 22 2A .......H..CAST\"*"
     - "00000310 6F 72 67 2E 61 70 61 63 68 65 2E 63 61 6C 63 69 org.apache.calci"
     - "00000320 74 65 2E 73 71 6C 2E 66 75 6E 2E 53 71 6C 43 61 te.sql.fun.SqlCa"
     - "00000330 73 74 46 75 6E 63 74 69 6F 6E 28 FF FF FF FF FF stFunction(....."
     - "00000340 FF FF FF FF 01 30 FF FF FF FF FF FF FF FF FF 01 .....0.........."
     - "00000350 1A 02 70 02 12 08 12 06 0A 02 10 05 10 04 12 1C ..p............."
     - "00000360 2A 1A 0A 04 08 01 10 05 12 06 0A 04 43 41 53 45 *...........CASE"
     - "00000370 1A 02 70 03 1A 02 70 04 1A 02 70 05 12 1E 2A 1C ..p...p...p...*."
     - "00000380 0A 02 10 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F ........GREATER_"
     - "00000390 54 48 41 4E 1A 02 70 06 1A 02 70 07 12 08 12 06 THAN..p...p....."
     - "000003A0 0A 02 10 05 10 05 12 0A 22 08 0A 04 08 01 10 05 ........\"......."
     - "000003B0 50 20 12 08 12 06 0A 02 10 05 10 04 12 0D 22 0B P ............\"."
     - "000003C0 0A 02 10 05 12 03 12 01 00 50 06                .........P."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$3], MOVING_AVG_SAL=[/(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4)])"
     - "  LogicalWindow(window#0=[window(partition {} order by [2] rows between $4 PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Cumulative Salary by Department Ordered by Hire Date"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    HIREDATE,\n    SUM(SAL) OVER (PARTITION BY DEPTNO ORDER BY HIREDATE ASC) AS CUMULATIVE_SALARY\nFROM \n    EMP"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKugEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjQESBUVNUE5PEgVFTkFNRRIISElSRURBVEUSA1NBTBIGREVQVE5PGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUaChIICgQIARAEEAcK0AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKkAggBGngKAQQaBBoCCAEiAhIAKgoKCAoGCAIQARgDMi16KwodahsKEQoCEAUSBwoFQ09VTlQaAnAAEgYKAhgBIAMSChIICgQIARAEEAMyLnosCh5qHAoQCgIQBRIGCgRTVU0wGgJwABIGCgIYASADGAESChIICgQIARAEEAMipQEQKEgCUg0KBUVNUE5PGgQIARAEUjsKBUVOQU1FEAEaMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVIUCghISVJFREFURRACGgYIARANIANSDQoDU0FMEAMaBAgBEARSEAoGREVQVE5PEAQaBAgBEARSDQoFdzAkbzAQBRoCEAVSDQoFdzAkbzEQBhoCEAUKwAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSkwIIAhIFRU1QTk8SBUVOQU1FEgZERVBUTk8SA1NBTBIISElSRURBVEUSEUNVTVVMQVRJVkVfU0FMQVJZGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAEGgoSCAoECAEQBBADGgwSCgoGCAEQDSADEAIab3ptChwqGgoECAEQBRIGCgRDQVNFGgJwABoCcAEaAnACEh4qHAoCEAESDgoMR1JFQVRFUl9USEFOGgJwAxoCcAQSCBIGCgIQBRAGEgoiCAoECAEQBVAgEggSBgoCEAUQBRINIgsKAhAFEgMSAQBQBg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A BA 01 0A 28 74 79 70 65 2E 67 ..EMP.º..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 8D 01 12 05 45 4D 50 4E 4F 12 05 45 4E ct.....EMPNO..EN"
     - "00000070 41 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 AME..HIREDATE..S"
     - "00000080 41 4C 12 06 44 45 50 54 4E 4F 1A 08 12 06 0A 04 AL..DEPTNO......"
     - "00000090 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 .....6.4.0.... ."
     - "000000A0 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "000000B0 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "000000C0 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0C 12 0A ISO-8859-1......"
     - "000000D0 0A 06 08 01 10 0D 20 03 10 04 1A 0A 12 08 0A 04 ...... ........."
     - "000000E0 08 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 ................"
     - "000000F0 10 07 0A D0 02 0A 27 74 79 70 65 2E 67 6F 6F 67 ...Ð..'type.goog"
     - "00000100 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000110 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F 77 12 A4 PLogicalWindow.¤"
     - "00000120 02 08 01 1A 78 0A 01 04 1A 04 1A 02 08 01 22 02 ....x.........\"."
     - "00000130 12 00 2A 0A 0A 08 0A 06 08 02 10 01 18 03 32 2D ..*...........2-"
     - "00000140 7A 2B 0A 1D 6A 1B 0A 11 0A 02 10 05 12 07 0A 05 z+..j..........."
     - "00000150 43 4F 55 4E 54 1A 02 70 00 12 06 0A 02 18 01 20 COUNT..p....... "
     - "00000160 03 12 0A 12 08 0A 04 08 01 10 04 10 03 32 2E 7A .............2.z"
     - "00000170 2C 0A 1E 6A 1C 0A 10 0A 02 10 05 12 06 0A 04 53 ,..j...........S"
     - "00000180 55 4D 30 1A 02 70 00 12 06 0A 02 18 01 20 03 18 UM0..p....... .."
     - "00000190 01 12 0A 12 08 0A 04 08 01 10 04 10 03 22 A5 01 .............\"¥."
     - "000001A0 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000001B0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000001C0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001D0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001E0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001F0 52 14 0A 08 48 49 52 45 44 41 54 45 10 02 1A 06 R...HIREDATE...."
     - "00000200 08 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 03 1A .... .R...SAL..."
     - "00000210 04 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 .....R...DEPTNO."
     - "00000220 04 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 6F 30 .......R...w0$o0"
     - "00000230 10 05 1A 02 10 05 52 0D 0A 05 77 30 24 6F 31 10 ......R...w0$o1."
     - "00000240 06 1A 02 10 05 0A C0 02 0A 28 74 79 70 65 2E 67 ......À..(type.g"
     - "00000250 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000260 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000270 63 74 12 93 02 08 02 12 05 45 4D 50 4E 4F 12 05 ct.......EMPNO.."
     - "00000280 45 4E 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 ENAME..DEPTNO..S"
     - "00000290 41 4C 12 08 48 49 52 45 44 41 54 45 12 11 43 55 AL..HIREDATE..CU"
     - "000002A0 4D 55 4C 41 54 49 56 45 5F 53 41 4C 41 52 59 1A MULATIVE_SALARY."
     - "000002B0 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 ..........6.4.0."
     - "000002C0 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "000002D0 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "000002E0 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "000002F0 01 1A 0A 12 08 0A 04 08 01 10 04 10 04 1A 0A 12 ................"
     - "00000300 08 0A 04 08 01 10 04 10 03 1A 0C 12 0A 0A 06 08 ................"
     - "00000310 01 10 0D 20 03 10 02 1A 6F 7A 6D 0A 1C 2A 1A 0A ... ....ozm..*.."
     - "00000320 04 08 01 10 05 12 06 0A 04 43 41 53 45 1A 02 70 .........CASE..p"
     - "00000330 00 1A 02 70 01 1A 02 70 02 12 1E 2A 1C 0A 02 10 ...p...p...*...."
     - "00000340 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 .....GREATER_THA"
     - "00000350 4E 1A 02 70 03 1A 02 70 04 12 08 12 06 0A 02 10 N..p...p........"
     - "00000360 05 10 06 12 0A 22 08 0A 04 08 01 10 05 50 20 12 .....\".......P ."
     - "00000370 08 12 06 0A 02 10 05 10 05 12 0D 22 0B 0A 02 10 ...........\"...."
     - "00000380 05 12 03 12 01 00 50 06                         ......P."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$4], SAL=[$3], HIREDATE=[$2], CUMULATIVE_SALARY=[CASE(>($5, 0), $6, null:BIGINT)])"
     - "  LogicalWindow(window#0=[window(partition {4} order by [2] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"

